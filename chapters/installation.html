

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Installation &mdash; How to make a python package 0.0.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Unit Testing" href="unittesting.html" />
    <link rel="prev" title="Introduction" href="introduction.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> How to make a python package
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#actual-installation">Actual installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setup-cfg"><code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#scripts-argument">Scripts argument</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#setup-py"><code class="docutils literal notranslate"><span class="pre">setup.py</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#environment-yml"><code class="docutils literal notranslate"><span class="pre">environment.yml</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="unittesting.html">Unit Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="API.html"><code class="docutils literal notranslate"><span class="pre">matpy</span></code> API</a></li>
<li class="toctree-l1"><a class="reference internal" href="pypi.html">Distributing your package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">How to make a python package</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Installation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/chapters/installation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>There are two things necessary for a good Python package installation. First,
the <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> and/or <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> files which control the installation of the package itself.
This is needed, if you want to create your package and use it like a pip
installed package. The other thing is the <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> which is used to
set up the environment for the installation. For this small project, the
<code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> is using a sledgehammer to crack a nut. We will still want to
keep it here for completeness.</p>
<div class="section" id="actual-installation">
<h2>Actual installation<a class="headerlink" href="#actual-installation" title="Permalink to this headline">¶</a></h2>
<p>Having all these corner stones in place, we simply need to install it. This
is simply done by the following line of code.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install your package</span>
pip install -e .
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">-e</span></code> simply let’s you modify the package without having to reinstall it
all the time. So, testing of the package can be done with every change of the
source files even though there is no re-installation. Note that this is only
necessary for packages that you install from the source code and plan on
modifying!</p>
</div>
<div class="section" id="setup-cfg">
<span id="id1"></span><h2><code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code><a class="headerlink" href="#setup-cfg" title="Permalink to this headline">¶</a></h2>
<p>In newer installations, the <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> replaces parts of the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>
or, in many cases, even the whole file. Here, we define all the options that
we want <code class="docutils literal notranslate"><span class="pre">setuptools.setup()</span></code> to use when executing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span>
</pre></div>
</div>
<p>First, let’s have a look at the file in our project:</p>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">[</span>metadata<span class="o">]</span>
<span class="c1"># replace with your username:</span>
<span class="nv">name</span> <span class="o">=</span> htmapp
<span class="nv">version</span> <span class="o">=</span> <span class="m">0</span>.0.4
<span class="nv">author</span> <span class="o">=</span> Lucas Sawade, Peter Makus
<span class="nv">author_email</span> <span class="o">=</span> lsawade@princeton.edu
<span class="nv">description</span> <span class="o">=</span> How to make a Python package.
<span class="nv">long_description</span> <span class="o">=</span> file: README.md
<span class="nv">long_description_content_type</span> <span class="o">=</span> text/markdown
<span class="nv">url</span> <span class="o">=</span> https://github.com/lsawade/how_to_make_a_python_package
<span class="nv">project_urls</span> <span class="o">=</span>
    <span class="nv">Documentation</span> <span class="o">=</span> https://how-to-make-a-python-package.readthedocs.io/en/latest/
    <span class="nv">TravisCI</span> <span class="o">=</span> https://travis-ci.com/github/lsawade/how_to_make_a_python_package
<span class="nv">classifiers</span> <span class="o">=</span>
    Programming Language :: Python :: <span class="m">3</span>
    License :: OSI Approved :: GNU General Public License v3 or later <span class="o">(</span>GPLv3+<span class="o">)</span>
    Operating System :: OS Independent
<span class="nv">keywords</span> <span class="o">=</span> Fun, Education, Learning, Programming

<span class="o">[</span>options<span class="o">]</span>
<span class="nv">package_dir</span> <span class="o">=</span>
    <span class="o">=</span> src
<span class="nv">packages</span> <span class="o">=</span> find:
<span class="nv">python_requires</span> <span class="o">=</span> &gt;<span class="o">=</span><span class="m">3</span>.6
<span class="nv">install_requires</span> <span class="o">=</span> numpy
<span class="nv">tests_require</span> <span class="o">=</span> pytest
<span class="nv">zip_safe</span> <span class="o">=</span> False

<span class="o">[</span>options.extras_require<span class="o">]</span>
<span class="nv">docs</span> <span class="o">=</span> 
    sphinx 
    sphinx-rtd-theme
<span class="nv">tests</span> <span class="o">=</span> pytest<span class="p">;</span> py

<span class="o">[</span>options.entry_points<span class="o">]</span>
<span class="nv">console_scripts</span> <span class="o">=</span>
    sample-bin <span class="o">=</span> matpy.bins.sample_bin:main

<span class="o">[</span>options.packages.find<span class="o">]</span>
<span class="nv">where</span> <span class="o">=</span> src
</pre></div>
</td></tr></table></div>
<p>Most of the defined options are quite self-explanatory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>options.packages.find<span class="o">]</span>
<span class="nv">where</span> <span class="o">=</span> src
</pre></div>
</div>
<p>defines where the package is located. Typically, we have a <code class="docutils literal notranslate"><span class="pre">src</span></code> folder that
contains the whole package. This line changes the import structure so that we
can later run <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">matpy</span></code> instead of <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">src.matpy</span></code>. For a list of
all available parameters and their correct syntax check out the
<a class="reference external" href="https://setuptools.readthedocs.io/en/latest/userguide/declarative_config.html">setuptools documentation</a>.</p>
<div class="section" id="scripts-argument">
<h3>Scripts argument<a class="headerlink" href="#scripts-argument" title="Permalink to this headline">¶</a></h3>
<p>The scripts argument lets you create executables that are installed upon
running the installation. For example, in the directory <code class="docutils literal notranslate"><span class="pre">bins</span></code> (binaries,
which are not technically binaries in this case, but used in the same way as
traditional binary files), there is the executable sample-bin:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">matpy</span> <span class="kn">import</span> <span class="n">MatrixMultiplication</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="c1"># Use this to set the logger to different levels.</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;matpy&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># Set up tests arrays</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>

    <span class="c1"># Use class and function call</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">MatrixMultiplication</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;matmul&#39;</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>It is normal Python code, but after installation</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -e .
</pre></div>
</div>
<p>you can simply run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sample-bin
</pre></div>
</div>
<p>from anywhere on your computer, which will run the python command <code class="docutils literal notranslate"><span class="pre">sample_bin()</span></code>. Do make sure that this filenames do not
conflict with your traditional command line tools such as <code class="docutils literal notranslate"><span class="pre">ls</span></code>, <code class="docutils literal notranslate"><span class="pre">cd</span></code>, etc.
Otherwise you won’t be able to use your created executables.</p>
</div>
</div>
<div class="section" id="setup-py">
<span id="id2"></span><h2><code class="docutils literal notranslate"><span class="pre">setup.py</span></code><a class="headerlink" href="#setup-py" title="Permalink to this headline">¶</a></h2>
<p>In some cases, you might still want to include a <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> which used
to be the old standard way. One of those cases is if you would like to be
able to use the <code class="docutils literal notranslate"><span class="pre">-e</span></code> (editable) <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code> command. Then, you would
just include a minimal <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> containing the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span>

<span class="c1"># configuration is done in setup.cfg</span>
<span class="n">setup</span><span class="p">()</span>
</pre></div>
</div>
<p>A second use-case of the <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> is illustrated in our sample file:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; :noindex:</span>
<span class="sd">Setup.py file that governs the installatino process of</span>
<span class="sd">`how_to_make_a_python_package` it is used by</span>
<span class="sd">`conda install -f environment.yml` which will install the package in an</span>
<span class="sd">environment specified in that file.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span>
<span class="kn">from</span> <span class="nn">setuptools.command.test</span> <span class="kn">import</span> <span class="n">test</span> <span class="k">as</span> <span class="n">testcommand</span>

<span class="c1"># This installs the pytest command. Meaning that you can simply type pytest</span>
<span class="c1"># anywhere and &quot;pytest&quot; will look for all available tests in the current</span>
<span class="c1"># directory and subdirectories recursively (not yet supported in the setup.cfg)</span>


<span class="k">class</span> <span class="nc">PyTest</span><span class="p">(</span><span class="n">testcommand</span><span class="p">):</span>
    <span class="n">user_options</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;pytest-args=&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s2">&quot;Arguments to pass to py.tests&quot;</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">initialize_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">testcommand</span><span class="o">.</span><span class="n">initialize_options</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pytest_args</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">run_tests</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">pytest</span>
        <span class="kn">import</span> <span class="nn">sys</span>
        <span class="n">errno</span> <span class="o">=</span> <span class="n">pytest</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pytest_args</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">errno</span><span class="p">)</span>


<span class="n">setup</span><span class="p">(</span><span class="n">cmdclass</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;tests&#39;</span><span class="p">:</span> <span class="n">PyTest</span><span class="p">})</span>
</pre></div>
</td></tr></table></div>
<p>Here, we add the <code class="docutils literal notranslate"><span class="pre">cmdclass</span></code> keyword, which is not supported by the
<code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> (at least, at the time of writing). After package installation,
when you in the repository, a simple</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest
</pre></div>
</div>
<p>will check all subdirectories for tests and run them subsequently. It is
amazing for debugging your code.
A third case is for more advanced dynamic installs, in which we wish to
compile our module differenly depending upon which machine it is installed
on (e.g., different OS or architecture).</p>
</div>
<div class="section" id="environment-yml">
<h2><code class="docutils literal notranslate"><span class="pre">environment.yml</span></code><a class="headerlink" href="#environment-yml" title="Permalink to this headline">¶</a></h2>
<p>This one is mainly to set up an environment and install dependencies there,
so that you main Python installation stays untouched and cannot be broken.
The general structure looks as follows:</p>
<div class="highlight-yaml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">htmapp</span>
<span class="nt">dependencies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">python=3.8</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">numpy</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">pip</span>
  <span class="p p-Indicator">-</span> <span class="nt">pip</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sphinx</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sphinx-rtd-theme</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">pytest</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">-e .</span>
</pre></div>
</td></tr></table></div>
<p><code class="docutils literal notranslate"><span class="pre">name</span></code> specifies the name of the environment to be created, and <code class="docutils literal notranslate"><span class="pre">pip</span></code>
defines extra packages that possibly aren’t available from the conda package
manager. And additional setting that is often used, but we are skipping here are
<code class="docutils literal notranslate"><span class="pre">channels</span></code>, which are online locations from where to grab the dependencies
when they are installed with conda (a typical example is conda-forge).
The file is pretty straightforward, so I’m gonna stop talking about it now.</p>
<p>To create an environment from the <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> file simply execute the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda env create -f environment.yml
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="unittesting.html" class="btn btn-neutral float-right" title="Unit Testing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="introduction.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, htmapp development team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>